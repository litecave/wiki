
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.4">
    
    
      
        <title>SMC - Free60 Wiki archive</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f7f47774.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-fifo" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Free60 Wiki archive" class="md-header__button md-logo" aria-label="Free60 Wiki archive" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Free60 Wiki archive
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SMC
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Free60 Wiki archive" class="md-nav__button md-logo" aria-label="Free60 Wiki archive" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Free60 Wiki archive
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Category_Xbox360_Hardware/" class="md-nav__link">
        Hardware
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Category_Xbox360_System_Software/" class="md-nav__link">
        System Software
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Category_Xbox360_Homebrew_Software/" class="md-nav__link">
        Homebrew Software
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Category_Xbox360_Linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Category_Xbox360_Development/" class="md-nav__link">
        Development
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Category_Support/" class="md-nav__link">
        Support
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../%21TODO/" class="md-nav__link">
        ToDo
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-fifo" class="md-nav__link">
    The FIFO
  </a>
  
    <nav class="md-nav" aria-label="The FIFO">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sending-a-message" class="md-nav__link">
    Sending a Message
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#receiving-a-reply" class="md-nav__link">
    Receiving a Reply
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-messages" class="md-nav__link">
    Command Messages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-messages" class="md-nav__link">
    Query Messages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-messages" class="md-nav__link">
    Event Messages
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>SMC</h1>
                
                <p>The <strong>System Management Controller (SMC)</strong> is an
<a href="8051_8052" title="wikilink">8051/8052</a> core inside the
<a href="Southbridge" title="wikilink">Southbridge</a>. It manages the power sequencing,
and is always active when the Xbox 360 has (standby or full) power
applied. It controls the frontpanel, has a Realtime clock, decodes IR,
manages temperatures, fans, DVDROM tray and a bunch of other things. It
talks with the frontpanel board to set the LEDs. When the system is
running, the kernel can communicate with the SMC, for example to query
the realtime clock, open the dvd-tray etc.</p>
<h2 id="the-fifo">The FIFO</h2>
<h3 id="sending-a-message">Sending a Message</h3>
<p>Communication between kernel and SMC happens over a bidirectional FIFO
(at ea001080 / ea001090).
All messages and replies are 16 byte long and have the command id in the
first byte.</p>
<p><code></p>
<pre><code>void smc_send(void *msg)
{
      while (!(readl(0xea001084) &amp; 4))    // wait for FIFO ready
              cpu_relax();

      writel(4, 0xea001084);              // start message
      writesl(0xea001080, msg, 4);        // send 16 bytes
      writel(0, 0xea001084);              // end message
}
</code></pre>
<p></code></p>
<h3 id="receiving-a-reply">Receiving a Reply</h3>
<p>Some messages have replies, which will be returned as 16 byte sequence
similar to the message (they also have the command id in the first
byte).</p>
<p><code></p>
<pre><code>int smc_read_reply(void *msg)
{
      if (!(readl(0xea001094) &amp; 4))       // do we have a reply?
              return 0;

      writel(4, 0xea001094);              // start reply
      readsl(0xea001090, msg, 4);         // read 16 bytes
      writel(0, 0xea001094);              // end reply
      return 1;
}
</code></pre>
<p></code></p>
<h2 id="command-messages">Command Messages</h2>
<table>
<thead>
<tr>
<th>ID</th>
<th>Len</th>
<th>Example</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="SMC_Command_0x82" title="wikilink">0x82</a></td>
<td>2-3</td>
<td>"\x82\0x04\0x31\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td>set standby/power</td>
</tr>
<tr>
<td>0x85</td>
<td>?</td>
<td>?</td>
<td>set real time clock</td>
</tr>
<tr>
<td>0x88</td>
<td>?</td>
<td>?</td>
<td>set fan algorithm</td>
</tr>
<tr>
<td>0x89</td>
<td>?</td>
<td>?</td>
<td>set fan speed (cpu/gpu?)</td>
</tr>
<tr>
<td>0x8b</td>
<td>?</td>
<td>"\x8b\0x62\0x00\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td>set dvd tray</td>
</tr>
<tr>
<td>0x8c</td>
<td>3</td>
<td>"\x8c\0x01\0x00\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td>set power led</td>
</tr>
<tr>
<td>0x8d</td>
<td>2</td>
<td>"\x8d\0x01\0x00\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td>set audio mute</td>
</tr>
<tr>
<td>0x94</td>
<td>?</td>
<td>?</td>
<td>set fan speed (cpu/gpu?)</td>
</tr>
<tr>
<td>0x95</td>
<td>?</td>
<td>?</td>
<td>set ir address</td>
</tr>
<tr>
<td>0x98</td>
<td>1</td>
<td>"\x98\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td>set dvd tray secure</td>
</tr>
<tr>
<td>0x99</td>
<td>3</td>
<td>"\x99\0x01\0x0f\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td>set ring of light</td>
</tr>
<tr>
<td>0x9a</td>
<td>?</td>
<td>?</td>
<td>set rtc wake</td>
</tr>
</tbody>
</table>
<h2 id="query-messages">Query Messages</h2>
<table>
<thead>
<tr>
<th>ID</th>
<th>Len</th>
<th>Example Query</th>
<th>Example Reply</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="SMC_Command_0x01" title="wikilink">0x01</a></td>
<td>1:6</td>
<td>"\x01\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>01 12 00 00 00 00</code></td>
<td>power on type</td>
</tr>
<tr>
<td>0x04</td>
<td>1:11</td>
<td>"\x04\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>04 602f 212223 01 00000000</code></td>
<td>real time clock</td>
</tr>
<tr>
<td>0x07</td>
<td>1:10</td>
<td>"\x07\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>07ff 241b 2fa4 2cfa 262c</code></td>
<td>read temps</td>
</tr>
<tr>
<td>0x0a</td>
<td>1:2</td>
<td>"\x0a\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>0a 60</code></td>
<td>request tray state</td>
</tr>
<tr>
<td>0x0f</td>
<td>1:2</td>
<td>"\x0f\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>0f 54</code></td>
<td>request AV pack type</td>
</tr>
<tr>
<td>0x11</td>
<td>6:2</td>
<td>"\x11\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>11 02</code></td>
<td>read ana</td>
</tr>
<tr>
<td>0x12</td>
<td>1:6</td>
<td>"\x12\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>1241 0203 0000</code></td>
<td>request SMC version</td>
</tr>
<tr>
<td>0x16</td>
<td>1:2</td>
<td>"\x16\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>16 0f</code></td>
<td>query IR address</td>
</tr>
<tr>
<td>0x17</td>
<td>1:2</td>
<td>"\x17\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</td>
<td><code>17 00</code></td>
<td>query tilt sensor</td>
</tr>
</tbody>
</table>
<h2 id="event-messages">Event Messages</h2>
<table>
<thead>
<tr>
<th>ID</th>
<th>Len</th>
<th>Example Message</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x83</td>
<td>2</td>
<td><code>83 64</code></td>
<td>SMC event</td>
</tr>
</tbody>
</table>
<p><a href="Category_Xbox360_Hardware">Category:Xbox360_Hardware</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.febc23d1.min.js"></script>
      
    
  </body>
</html>